## 해커톤 회고

2025년 2월 26~28일 해커톤이 성공적으로 마무리되었고, 카카오대표이사상을 수상했다.(서비스명 : dAIry)
우리 서비스에 대한 설명은 오거니제이션에서 진행할테니, 트러블슈팅한 내용만 간단하게 기재해보려고 한다.

### 1. 서버 투 서버의 api 명세의 중요성
   - 프론트와 백의 명세서는 기획단계에서 작성하여 메서드나 데이터 타입 등이 공유되어 해당 부분으로 인한 큰 수정 및 충돌은 없었다. 
   - 하지만 백엔드와 ai를 구동할 fastApi서버간 명세세서를 작성하지 않아 메서드명이 충돌하는 것을 알게 되었다.
   - fastapi와 백엔드간 통신할 기능이 하나밖에 없어서 '메서드 하나밖에 작성 안하는데 뭐'라는 생각으로 개발을 했는데, 개발 중 메서드가 충돌한 것이다.
   - 다행히 충돌 직후해당 기능에 대해 기능 명세를 다시 할 시간이 있어 소통하고 있는 디스코드를 통해 개발하고 있던 메서드를 맞추어보았고, fastAPI의 메서드를 get에서 post로 변경하도록 유도했다.
     - **[이러면 좋았을텐데]** 개발 전에 프론트-백엔드 명세서 작성하듯이 ai 포지션과 기능 명세를 간단하게 논의했으면 좋았을걸
     - 아니면 비즈니스 로직 말고 post메서드를 받는 fastAPI 서버 뼈대를 만들어서 넘겨줄걸

### 2. 데이터베이스 관리 이슈
- postman으로 데이터를 생성하는 것은 잘 하는데 데이터베이스에 데이터를 넣고 빼는 과정에서 nullpointException이 발생했다.
- 왜지...하고 모든 코드와 분기에 로그를 찍어보았다. 그 결과 데이터를 저장하고 빼오는 과정에서 npe가 발생한다는 사실을 알았다.
- 로그를 찍지 않았으면 절대 몰랐을 것이다. 왜냐고? 로직상에는 전혀 문제가 없다고 보였고, 실제로 로직에는 문제가 전혀 없었다.
- 다만, 테스트를 하기 위해 포스트맨으로 post 요청했던 데이터가 문제가 있었다. notnull을 설정하거나, 테스트할 때 db 나중에 붙이는 것이 좋다는 것을 깨달았다.
  - **[이러면 좋았을텐데]** 일단 concurrentmap으로 구현, 그 다음에 기능 구현 후 테스트해보고 나중에 db 붙이기
  - 이렇게 하면 서버를 시작할때마다 맵이 초기화되기 때문에 올바른 비즈니스 로직이라는 가정 하에 문제가 발생하지 않았을 거다(이걸로 몇시간 씀..)


### 3. 외래키 남발
- 첫 구현이기도 하고 그래서 인텔리제이가 시키는대로 한 값에 여러 데이터를 저장해야 하면 바로 외래키로 빼버렸다.
- 그러니까 테이블이 너무 많아져서 나중에 관리할 때도 너무 어려웠고, 배포 후 db테스트를 위한 SQL문을 클라우드담당에게 넘겨줄때도 너무 SQL문이 복잡해졌다.
  - **[이러면 좋았을텐데]** 간단한 서비스의 db는 같은 속성이라면 일단 한 테이블에 두는 것을 전제로 하고, 너무 찾는 것이 힘들다면 그때 정규화를 고려하는 것도 방법일 듯 하다.